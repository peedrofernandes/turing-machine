(()=>{"use strict";function t(t){return"string"==typeof t&&/^.$/.test(t)}class a{getDados(){return{Q:this._Q,Σ:this._Σ,Γ:this._Γ,δ:this._δ,q0:this._q0,qA:this._qA,qR:this._qR}}operacao(){var t;const{conteudo:a,estadoAtual:e,cabecote:i}=this._fita,s=null!==(t=a[i])&&void 0!==t?t:" ";if("Computando"!=this._status)return;if(i>1e3)throw new Error("A produção ficou muito longa (provavalmente a MT entrou em loop!)");if(e===this._qA)return this._status="Aceitou",void this.controlador.finalizarComputacao(this._status);if(e===this._qR)return this._status="Rejeitou, estado de rejeição",void this.controlador.finalizarComputacao(this._status);const o=this._δ.find((t=>t[0]===e&&t[1]===s));if(!o)return this._status="Rejeitou por indefinição",void this.controlador.finalizarComputacao(this._status);const[,,n,r,c]=o;this._fita.conteudo=this._fita.conteudo.slice(0,i)+r+this._fita.conteudo.slice(i+1),this._fita.estadoAtual=n,"Direita"===c?this._fita.cabecote=i+1:"Esquerda"===c&&(this._fita.cabecote=i-1<=0?0:i-1),this.controlador.aplicarTransicao(o),this._operationTimeoutID=setTimeout((()=>this.operacao()),1e3/this._tick)}constructor(a,e){this._palavraEntrada="";const{δ:i,q0:s,qA:o,qR:n}=a,r=[...new Set(i.flatMap((([t,a,e,i,s])=>[t,e])).concat([s,o,n]))].sort();if(r.some((t=>t.includes(" "))))throw new Error("Nomes de estados não podem ter espaço!");if(new Set(r).size!==r.length)throw new Error("Estados devem ter nomes diferentes!");if(!(r.includes(s)&&r.includes(o)&&r.includes(n)))throw new Error("Os estados iniciais, de aceitação e de rejeição devem estar contidos no conjunto de estados!");if(o===n)throw new Error("Os estados de aceitação e de rejeição devem ser diferentes!");if(i.some((([t,a],e)=>i.filter(((t,a)=>a!==e)).some((([e,i])=>t===e&&a===i)))))throw new Error("Não pode haver duas possibilidades para a mesma transição!");if(i.some((a=>!(t(a[1])&&t(a[3])))))throw new Error("Os símbolos das funções de transição devem conter apenas um caracter!");this._Q=r,this._δ=i,this._q0=s,this._qA=o,this._qR=n,this._Γ="",this._Σ="",this._tick=1,this._status="Não iniciada",this._fita={conteudo:"",estadoAtual:this._q0,cabecote:0},this.controlador=e,this.controlador.construirMaquinaTuring({Q:this._Q,Σ:this._Σ,Γ:this._Γ,δ:this._δ,q0:this._q0,qA:this._qA,qR:this._qR})}pausar(){this._status="Pausada",this.controlador.pausarComputacao()}retomar(){this._operationTimeoutID&&clearTimeout(this._operationTimeoutID),this._status="Computando",this.controlador.iniciarComputacao(),this._operationTimeoutID=setTimeout((()=>this.operacao()),1e3/this._tick)}reinicializar(){this._fita.conteudo=this._palavraEntrada,this._fita.cabecote=0,this._fita.estadoAtual=this._q0,this._status="Não iniciada",this.controlador.reinicializarMaquinaTuring()}inicializar(t,a){this._palavraEntrada=t,this._fita.conteudo=t,this._fita.cabecote=0,this._fita.estadoAtual=this._q0,this._Σ=[...new Set(this._palavraEntrada)].sort().join(""),this._Γ=[...new Set(this._Σ.split("").concat(this._δ.flatMap((([t,a,e,i])=>[a,i]))).concat(" "))].sort().join(""),this._status="Não iniciada",this.controlador.inicializarMaquinaTuring(this._Σ,this._Γ,this._palavraEntrada),a&&(this._tick=a)}rodar(){if(!this._fita.conteudo)throw new Error("Não há palavra de entrada para ser computada!");console.log("Rodar executando!"),this._status="Computando",this.controlador.iniciarComputacao(),this.operacao()}mudarTick(t){this.controlador.alterarTick(t),this._tick=t}get Q(){return this._Q}get Σ(){return this._Σ}get Γ(){return this._Γ}get δ(){return this._δ}get q0(){return this._q0}get qA(){return this._qA}get qR(){return this._qR}get palavraEntrada(){return this._palavraEntrada}get tick(){return this._tick}get status(){return this._status}}class e{direita(){this._posPx-=60,setTimeout((()=>{this._fita.style.transform=`translateX(${this._posPx}px)`}),10)}esquerda(){this._posPx+=60,setTimeout((()=>{this._fita.style.transform=`translateX(${this._posPx}px)`}),10)}falsoMovEsquerda(){this._fita.style.transform=`translateX(${this._posPx+32}px)`,setTimeout((()=>{this._fita.style.transform=`translateX(${this._posPx}px)`}),1e3/this._tick*.2)}corrigirTranslate(){const t=Math.abs(this._posAtual-this._posAnterior),a=Math.max(this._posAnterior,this._posAtual),e=Math.min(this._posAnterior,this._posAtual);let i=t-(Math.min(a,this._qtdElementsEachSide)-Math.min(e,this._qtdElementsEachSide));this._posAtual<this._posAnterior&&(i*=-1);const s=this._fita.style.transitionDuration;this._fita.style.transitionDuration="0s",this._posPx+=60*i,console.log("CORREÇÃO DA FITA!!!"),console.log(`posPx: ${this._posPx}`),setTimeout((()=>{this._fita.style.transform=`translateX(${this._posPx}px)`,this._fita.style.transitionDuration=s}),1)}preencherCelulas(){this._fita.innerHTML="";let t=[],a=0,e=this._posAtual-1;for(;a<this._qtdElementsEachSide&&!(e<0);){const i=document.createElement("li");i.classList.add("celula"),0==e&&(i.id="primeira-celula"),i.innerText=this._conteudo[e]||" ",t.push(i),e--,a++}this.corrigirTranslate(),t.reverse();const i=document.createElement("li");i.classList.add("celula"),i.innerText=this._conteudo[this._posAtual]||" ",t.push(i);let s=[];for(a=0,e=this._posAtual+1;a<this._qtdElementsEachSide;){const t=document.createElement("li");t.classList.add("celula"),t.innerText=this._conteudo[e]||" ",s.push(t),e++,a++}return t.concat(s).forEach((t=>this._fita.appendChild(t))),i}animarTransicaoCelula(t){setTimeout((()=>{t.style.transitionDuration="0ms",t.style.color="#3498db",setTimeout((()=>{t.style.transitionDuration=1e3/this._tick*.2+"ms",t.style.color="#111414"}),1e3/this._tick*.2)}),10)}setCor(t,a){t.className=t.className.replace(/(^|\s)cor-\w+/g,"").trim(),t.classList.add(`cor-${a}`)}constructor(t){this._posPx=0,this._tick=1,this._conteudo="",this._posAtual=0,this._posAnterior=0,this._qtdTransicoesParaAtualizacao=0,this._qtdElementsEachSide=64,this._palavraEntrada="",this._estadoInicial="",this._fita=t.fita,this._spanEstadoInicial=t.spanEstadoInicial,this._spanEstadoRejeicao=t.spanEstadoRejeicao,this._spanEstadoAceitacao=t.spanEstadoAceitacao,this._spanEstadoAtual=t.spanEstadoAtual,this._spanSituacaoAtual=t.spanSituacaoAtual,this._spanTransicaoAtual=t.spanTransicaoAtual,this._spanAlfabetoEntrada=t.spanAlfabetoEntrada,this._spanAlfabetoFita=t.spanAlfabetoFita,this._spanConjEstados=t.spanConjEstados,this._ulTransicoes=t.ulTransicoes,this._fita.style.transitionDuration=1e3/this._tick*.75+"ms",this._celulaAtual=this.preencherCelulas()}get p(){return this._posPx}construirMaquinaTuring(t){const{Q:a,Σ:e,Γ:i,δ:s,q0:o,qA:n,qR:r}=t;this._spanConjEstados.innerText=`{'${a.join("', '")}'}`,this._ulTransicoes.innerHTML="",s.map((([t,a,e,i,s])=>{const o=document.createElement("li");return o.innerText=`δ (${t}, '${a}') = (${e}, '${i}', ${s})`,o})).sort().forEach((t=>this._ulTransicoes.appendChild(t))),this._estadoInicial=o,this._spanEstadoInicial.innerText=o,this._spanEstadoRejeicao.innerText=r,this._spanEstadoAceitacao.innerText=n}inicializarMaquinaTuring(t,a,e){this._palavraEntrada=e,this._spanAlfabetoEntrada.innerText=`{'${t.split("").join("', '")}'}`,this.setCor(this._spanAlfabetoEntrada,"preto"),this._spanAlfabetoFita.innerText=`{'${a.split("").join("', '")}'}`,this.setCor(this._spanAlfabetoFita,"preto"),this.reinicializarMaquinaTuring()}reinicializarMaquinaTuring(){this._posAtual=0,this._posAnterior=0,this._conteudo=this._palavraEntrada,this._posPx=0,this._celulaAtual=this.preencherCelulas(),this.setCor(this._spanEstadoAtual,"azul"),this.setCor(this._spanTransicaoAtual,"azul"),this.setCor(this._fita,"preto"),this.setCor(this._spanSituacaoAtual,"amarelo"),this._spanSituacaoAtual.innerText="Aguardando",this.setCor(this._spanEstadoAtual,"azul"),this._spanEstadoAtual.innerText=this._estadoInicial||"N/A",this.setCor(this._spanTransicaoAtual,"cinza"),this._spanTransicaoAtual.innerText="N/A"}iniciarComputacao(){this.setCor(this._spanSituacaoAtual,"verde"),this._spanSituacaoAtual.innerText="Computando"}pausarComputacao(){this.setCor(this._spanSituacaoAtual,"amarelo"),this._spanSituacaoAtual.innerText="Pausado"}aplicarTransicao(t){const[a,e,i,s,o]=t;if(this._conteudo=this._conteudo.slice(0,this._posAtual)+s+this._conteudo.slice(this._posAtual+1),this._celulaAtual.innerText=s,"Direita"===o)this.direita(),this.animarTransicaoCelula(this._celulaAtual),this._celulaAtual=this._celulaAtual.nextElementSibling,this._posAtual++;else{const t=this._celulaAtual.previousElementSibling;t?(this.esquerda(),this.animarTransicaoCelula(this._celulaAtual),this._celulaAtual=t,this._posAtual--):(this.falsoMovEsquerda(),this.animarTransicaoCelula(this._celulaAtual))}this._qtdTransicoesParaAtualizacao++,this._qtdTransicoesParaAtualizacao>32&&(this._celulaAtual=this.preencherCelulas(),this._posAnterior=this._posAtual,this._qtdTransicoesParaAtualizacao=0),this._spanEstadoAtual.innerText=i,this._spanTransicaoAtual.innerText=`δ(${a}, '${e}') = (${i}, '${s}', ${o})`}finalizarComputacao(t){"Aceitou"===t?(this.setCor(this._spanSituacaoAtual,"verde"),this.setCor(this._fita,"verde")):(this.setCor(this._spanSituacaoAtual,"vermelho"),this.setCor(this._fita,"vermelho")),this._spanSituacaoAtual.innerText=t}alterarTick(t){this._tick=t;const a=1e3/t*.75;this._fita.style.transitionDuration=`${a}ms`}}class i{constructor(){const t=document.querySelector("#fita");if(!t)throw new Error("Fita não identificada.");this._fita=t;const a=document.querySelector("#q0-content");if(!a)throw new Error("Span de estado inicial não identificado.");this._spanEstadoInicial=a;const e=document.querySelector("#qR-content");if(!e)throw new Error("Span de estado de rejeição não identificado.");this._spanEstadoRejeicao=e;const i=document.querySelector("#qA-content");if(!i)throw new Error("Span de estado de aceitação não identificado.");this._spanEstadoAceitacao=i;const s=document.querySelector("#estado-atual-content");if(!s)throw new Error("Span de estado atual não identificado.");this._spanEstadoAtual=s;const o=document.querySelector("#situacao-atual-content");if(!o)throw new Error("Span de situacao atual não identificado.");this._spanSituacaoAtual=o;const n=document.querySelector("#transicao-atual-content");if(!n)throw new Error("Span de transicao atual não identificado.");this._spanTransicaoAtual=n;const r=document.querySelector("#alfabeto-entrada-content");if(!r)throw new Error("Span de alfabeto de entrada não identificado.");this._spanAlfabetoEntrada=r;const c=document.querySelector("#alfabeto-fita-content");if(!c)throw new Error("Span de alfabeto da fita não identificado.");this._spanAlfabetoFita=c;const l=document.querySelector("#conjunto-estados-content");if(!l)throw new Error("Span de conjunto de estados não identificado.");this._spanConjEstados=l;const h=document.querySelector("#transicoes-content");if(!h)throw new Error("UL do conjunto de transicoes não identificado.");this._ulTransicoes=h}get fita(){return this._fita}get spanEstadoAtual(){return this._spanEstadoAtual}get spanEstadoInicial(){return this._spanEstadoInicial}get spanEstadoAceitacao(){return this._spanEstadoAceitacao}get spanEstadoRejeicao(){return this._spanEstadoRejeicao}get spanTransicaoAtual(){return this._spanTransicaoAtual}get spanAlfabetoEntrada(){return this._spanAlfabetoEntrada}get spanAlfabetoFita(){return this._spanAlfabetoFita}get spanConjEstados(){return this._spanConjEstados}get ulTransicoes(){return this._ulTransicoes}get spanSituacaoAtual(){return this._spanSituacaoAtual}}class s{static generateElementFromString(t){const a=document.createElement("div");if(a.innerHTML=t,a.children.length<=0||!a.firstElementChild)throw new Error("Invalid component string provided to generate an element.");const e=a.firstElementChild;return a.removeChild(e),e}static createIconComponent(t,a,e){const{path:i,viewBox:s}=t,o=`\n      <svg\n        height="${a}"\n        width="${a}"\n        xmlns="http://www.w3.org/2000/svg"\n        viewBox="${s[0]} ${s[1]} ${s[2]} ${s[3]}" \n      >\n        <path fill="${null!=e?e:"#black"}" d="${t.path}"/>\n      </svg>\n    `;return this.generateElementFromString(o)}static settingsIcon(t,a){return this.createIconComponent(this._settingsIcon,null!=t?t:this._defaultIconSize,a)}static playIcon(t,a){return this.createIconComponent(this._playIcon,null!=t?t:this._defaultIconSize,a)}static pauseIcon(t,a){return this.createIconComponent(this._pauseIcon,null!=t?t:this._defaultIconSize,a)}static resetIcon(t,a){return this.createIconComponent(this._resetIcon,null!=t?t:this._defaultIconSize,a)}static fastForwardIcon(t,a){return this.createIconComponent(this._fastForwardIcon,null!=t?t:this._defaultIconSize,a)}static fastRewindIcon(t,a){return this.createIconComponent(this._fastRewindIcon,null!=t?t:this._defaultIconSize,a)}static closeIcon(t,a){return this.createIconComponent(this._closeIcon,null!=t?t:this._defaultIconSize,a)}}s._defaultIconSize=32,s._settingsIcon={path:"m388-80-20-126q-19-7-40-19t-37-25l-118 54-93-164 108-79q-2-9-2.5-20.5T185-480q0-9 .5-20.5T188-521L80-600l93-164 118 54q16-13 37-25t40-18l20-127h184l20 126q19 7 40.5 18.5T669-710l118-54 93 164-108 77q2 10 2.5 21.5t.5 21.5q0 10-.5 21t-2.5 21l108 78-93 164-118-54q-16 13-36.5 25.5T592-206L572-80H388Zm92-270q54 0 92-38t38-92q0-54-38-92t-92-38q-54 0-92 38t-38 92q0 54 38 92t92 38Zm0-60q-29 0-49.5-20.5T410-480q0-29 20.5-49.5T480-550q29 0 49.5 20.5T550-480q0 29-20.5 49.5T480-410Zm0-70Zm-44 340h88l14-112q33-8 62.5-25t53.5-41l106 46 40-72-94-69q4-17 6.5-33.5T715-480q0-17-2-33.5t-7-33.5l94-69-40-72-106 46q-23-26-52-43.5T538-708l-14-112h-88l-14 112q-34 7-63.5 24T306-642l-106-46-40 72 94 69q-4 17-6.5 33.5T245-480q0 17 2.5 33.5T254-413l-94 69 40 72 106-46q24 24 53.5 41t62.5 25l14 112Z",viewBox:[0,-960,960,960]},s._playIcon={path:"M320-202v-560l440 280-440 280Z",viewBox:[0,-960,960,960]},s._pauseIcon={path:"M556.667-200v-560h170v560h-170Zm-323.334 0v-560h170v560h-170Z",viewBox:[0,-960,960,960]},s._resetIcon={path:"M480-100.001q-70.769 0-132.615-26.462-61.846-26.461-108.153-72.769-46.308-46.307-72.769-108.153Q140.001-369.231 140.001-440h45.384q0 122.692 85.961 208.654Q357.308-145.385 480-145.385t208.654-85.961Q774.615-317.308 774.615-440t-84.038-208.654q-84.039-85.961-206.731-85.961h-23.385l71.846 71.461-31.383 31.615L373.54-759.307l128.153-127.768 31.384 31L457-779.999h23q70.769 0 132.615 26.462 61.846 26.461 108.153 72.769 46.308 46.307 72.769 108.153Q819.999-510.769 819.999-440t-26.462 132.615q-26.461 61.846-72.769 108.153-46.307 46.308-108.153 72.769Q550.769-100.001 480-100.001Z",viewBox:[0,-960,960,960]},s._fastForwardIcon={path:"M134.771-267.694v-424.612L443.076-480 134.771-267.694Zm382.768 0v-424.612L825.844-480 517.539-267.694Z",viewBox:[0,-960,960,960]},s._fastRewindIcon={path:"M823.613-267.694 515.308-480l308.305-212.306v424.612Zm-378.921 0L136.387-480l308.305-212.306v424.612Z",viewBox:[0,-960,960,960]},s._closeIcon={path:"m249-207-42-42 231-231-231-231 42-42 231 231 231-231 42 42-231 231 231 231-42 42-231-231-231 231Z",viewBox:[0,-960,960,960]};const o=s;class n{createErrorComponent(t){const a=document.createElement("li");a.classList.add("error-message");const e=document.createElement("span");e.textContent=t;const i=document.createElement("span");i.appendChild(o.closeIcon(20,"#fafafa")),i.classList.add("close");const s=document.createElement("div");s.classList.add("error-message-bar"),a.appendChild(i),a.appendChild(e),a.appendChild(s);const n={li:a,bar:s,text:t,spanContent:e,currentTransformY:0};return i.addEventListener("click",(()=>this.removeError(n))),n}pushNewError(t){const a=parseInt(getComputedStyle(t.li).height)+12;this.currentShownErrors.forEach((t=>{t.currentTransformY-=a,t.li.style.transform=`translateY(${t.currentTransformY}px)`})),this.currentShownErrors.push(t),console.log(this.currentShownErrors.length)}removeError(t){const a=this.currentShownErrors.indexOf(t);-1==a&&console.log("Index not found!"),setTimeout((()=>{t.li.style.opacity="0";const e=parseInt(getComputedStyle(t.li).height)+12;this.currentShownErrors.slice(0,a).forEach((t=>{t.currentTransformY+=e,t.li.style.transform=`translateY(${t.currentTransformY}px)`})),this.currentShownErrors.splice(a,1),setTimeout((()=>{t.li.remove()}),250)}),0)}constructor(){const t=document.querySelector("#errors-container");if(!t)throw new Error("Lista de erros não encontrada na DOM.");this.ulErrors=t,this.currentShownErrors=[]}static get instance(){return n._instance||(n._instance=new n),n._instance}showError(t){const a=this.createErrorComponent(t);this.ulErrors.appendChild(a.li),setTimeout((()=>{a.li.style.opacity="1",this.pushNewError(a);let t=100;const e=setInterval((()=>{a.bar.style.width=(t-=.25)+"%",t<=0&&(clearInterval(e),a.li.style.opacity="0",setTimeout((()=>{a.li.remove(),this.currentShownErrors.shift()}),250))}),25)}),0)}}class r{constructor(t){this._rodando=!1,this.eventoPlayPause=t=>{try{"Não iniciada"===this._maquinaTuring.status?(this._maquinaTuring.rodar(),this._botaoPlayPause.innerHTML="",this._botaoPlayPause.appendChild(o.pauseIcon(48,"#111414"))):this._rodando?(this._maquinaTuring.pausar(),this._botaoPlayPause.innerHTML="",this._botaoPlayPause.appendChild(o.playIcon(48,"#111414"))):(this._maquinaTuring.retomar(),this._botaoPlayPause.innerHTML="",this._botaoPlayPause.appendChild(o.pauseIcon(48,"#111414")))}catch(t){n.instance.showError(t)}this._rodando=!this._rodando},this.eventoInserirPalavra=t=>{this._rodando&&(this._botaoPlayPause.innerHTML="",this._botaoPlayPause.appendChild(o.playIcon(48,"#111414")),this._rodando=!1),this._maquinaTuring.inicializar(this._inputPalavra.value)},this.eventoReset=t=>{this._maquinaTuring.reinicializar(),this._rodando&&(this._botaoPlayPause.innerHTML="",this._botaoPlayPause.appendChild(o.playIcon(48,"#111414")),this._rodando=!1)},this.eventoDesaceleracao=t=>{let a;switch(this._maquinaTuring.tick){case 1:return;case 2:a=1;break;case 4:a=2;break;case 8:a=4;break;case 16:a=8;break;case 32:a=16}this._maquinaTuring.mudarTick(a),this._mostradorVelocidade.innerText=`x${a}`},this.eventoAceleracao=t=>{let a;switch(this._maquinaTuring.tick){case 1:a=2;break;case 2:a=4;break;case 4:a=8;break;case 8:a=16;break;case 16:a=32;break;case 32:return}this._maquinaTuring.mudarTick(a),this._mostradorVelocidade.innerText=`x${a}`},this._maquinaTuring=t;const a=document.querySelector("#inputPalavra");if(!a)throw new Error("Input de palavra não identificado.");this._inputPalavra=a;const e=document.querySelector("#settings");if(!e)throw new Error("Ícone de configurações não identificado.");e.appendChild(o.settingsIcon(48,"#111414")),e.addEventListener("click",(()=>{const t=localStorage.getItem("default-pathname");window.location.href=t||"/"})),this._botaoConfiguracoes=e;const i=document.querySelector("#play-pause");if(!i)throw new Error("Botão play/pause não identificado.");i.appendChild(o.playIcon(48,"#111414")),i.addEventListener("click",this.eventoPlayPause),this._botaoPlayPause=i;const s=document.querySelector("#inserirPalavra");if(!s)throw new Error("Botão de inserir palavra não identificado.");s.addEventListener("click",this.eventoInserirPalavra),this._botaoInserirPalavra=s;const r=document.querySelector("#reset");if(!r)throw new Error("Botão reset não encontrado.");r.appendChild(o.resetIcon(36,"#111414")),r.addEventListener("click",this.eventoReset),this._botaoReset=r;const c=document.querySelector("#speed");if(!c)throw new Error("Mostrador de velocidade não encontrado.");c.innerText="x1",this._mostradorVelocidade=c;const l=document.querySelector("#rewind");if(!l)throw new Error("Botão de rewind não encontrado.");l.appendChild(o.fastRewindIcon(48,"#111414")),l.addEventListener("click",this.eventoDesaceleracao),this._botaoDesaceleracao=l;const h=document.querySelector("#forward");if(!h)throw new Error("Botao de aceleração não identificado.");h.appendChild(o.fastForwardIcon(48,"#111414")),h.addEventListener("click",this.eventoAceleracao),this._botaoAceleracao=h}}const c=localStorage.getItem("default-pathname");try{const t=localStorage.getItem("entradaMT");if(!t)throw window.location.href=c||"/",new Error("Dados de entrada não identificados.");!function(t){const s=new e(new i),o=new a(t,s);new r(o)}(JSON.parse(t))}catch(t){t instanceof Error?(localStorage.setItem("errors",JSON.stringify([t.message])),window.location.href=c||"/"):console.log("Unhandled error - "+t)}})();